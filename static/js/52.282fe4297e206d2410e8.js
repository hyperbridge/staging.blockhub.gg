(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{1523:function(t,e,s){"use strict";s.r(e);var a=s(5),r=s.n(a),o=s(8),c=s.n(o),n=s(20),i=s.n(n),u={props:{id:[String,Number]},components:{"c-business-layout":function(t){return s.e(170).then(function(){var e=[s(1423)];t.apply(null,e)}.bind(this)).catch(s.oe)}},data:function(){return{loadingState:!0,creating:"new"===this.id,successfulCreationMessage:!1}},computed:{marketplace:function(){return this.$store.state.marketplace},product:function(){var t=this;return"new"===this.id?this.marketplace.default_product:this.marketplace.products.find(function(e){return e.id==t.id})}},methods:{transferOwnership:function(){var t=this,e={code:function(t,e,s,a,o,n,u,l,d,p,v){var m,f=this,h=v.product,_=v.profile;return new i.a((m=c()(r.a.mark(function t(e,s){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o.api.ethereum.state.contracts.MarketplaceStorage.deployed,t.next=3,marketplaceStorage.setDeveloperOwnsProduct(h.developer_id,h.id,!0,{from:_.public_address});case 3:return t.next=5,marketplaceStorage.pushDeveloperOwnedProduct(h.developer_id,h.id,{from:_.public_address});case 5:return t.next=7,marketplaceStorage.setProductDeveloper(h.id,h.developer,{from:_.public_address});case 7:return t.next=9,marketplaceStorage.setProductDeveloperId(h.id,h.developer_id,{from:_.public_address});case 9:e(h);case 10:case"end":return t.stop()}},t,f)})),function(t,e){return m.apply(this,arguments)}))}.toString(),params:{profile:this.$store.state.application.account.current_identity,product:this.product}};BlockHub.Bridge.sendCommand("eval",e).then(function(e){e.id&&(t.successfulCreationMessage="Product ownership has been changed")})},updateStatus:function(){var t=this,e={code:function(t,e,s,a,o,n,u,l,d,p,v){var m,f=this,h=v.product,_=v.profile;return new i.a((m=c()(r.a.mark(function t(e,s){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.api.ethereum.state.contracts.MarketplaceStorage.deployed,t.next=3,a.setProductStatus(productId,Number(h.status),{from:_.public_address});case 3:e(h);case 4:case"end":return t.stop()}},t,f)})),function(t,e){return m.apply(this,arguments)}))}.toString(),params:{profile:this.$store.state.application.account.current_identity,product:this.product}};BlockHub.Bridge.sendCommand("eval",e).then(function(e){e.id&&(t.successfulCreationMessage="Product status has been updated")})},create:function(){var t=this,e={code:function(t,e,s,a,o,n,u,l,d,p,v){var m,f=this,h=v.product,_=v.profile;return new i.a((m=c()(r.a.mark(function t(a,c){var n,i,u;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.api.ethereum.state.contracts.ProductRegistration.deployed,i=!1,u=n.ProductCreated().watch(function(t,r){if(!i){if(i=!0,t)return console.warn("[BlockHub][Marketplace] Error",t),c(t);h.$loki=void 0,h.id=r.args.productId.toNumber();try{e.marketplace.products.insert(h),console.log("after",h.id)}catch(t){try{e.marketplace.products.update(h)}catch(t){c(t)}}e.save(),s.sendCommand("updateState",{module:"marketplace",state:{products:e.marketplace.products.data}}),console.log("Product created"),a(h)}}),t.next=5,n.createProduct(h.name,h.type,h.content,{from:_.public_address});case 5:u.stopWatching(function(){});case 6:case"end":return t.stop()}},t,f)})),function(t,e){return m.apply(this,arguments)}))}.toString(),params:{profile:this.$store.state.application.account.current_identity,product:this.product}};BlockHub.Bridge.sendCommand("eval",e).then(function(e){e.id&&(t.product.id=e.id,t.successfulCreationMessage="Congratulations, your product has been created!",t.marketplace.products[t.product.id]=t.product,t.$router.push("/business/product/"+t.product.id))})},save:function(){var t=this,e={code:function(t,e,s,a,o,n,u,l,d,p,v){var m,f=this,h=v.product,_=v.profile;return new i.a((m=c()(r.a.mark(function t(e,s){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.api.ethereum.state.contracts.ProductRegistration.deployed,t.next=3,a.editProductInfo(h.id,h.name,h.type,h.content,{from:_.public_address});case 3:e(h);case 4:case"end":return t.stop()}},t,f)})),function(t,e){return m.apply(this,arguments)}))}.toString(),params:{profile:this.$store.state.application.account.current_identity,product:this.product}};BlockHub.Bridge.sendCommand("eval",e).then(function(e){e.id&&(t.successfulCreationMessage="Product has been saved")})}},mounted:function(){var t=this;this.$nextTick(function(){t.loadingState=!1,document.getElementById("startup-loader").style.display="none"})}},l=(s(809),s(0)),d=Object(l.a)(u,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("c-business-layout",{attrs:{title:"Product Creation"}},[s("div",[s("div",{staticClass:"container-fluid"},[s("div",{staticClass:"row"},[t.successfulCreationMessage?s("div",{staticClass:"col-md-12"},[s("p",{staticClass:"alert alert-info"},[t._v(t._s(t.successfulCreationMessage))]),t._v(" "),s("br"),s("br")]):t._e(),t._v(" "),s("div",{staticClass:"col-md-6"},[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"switch switch-sm col-sm-3"},[s("label",[t._v("Change Status")])]),t._v(" "),s("div",{staticClass:"col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.product.status,expression:"product.status"}],staticClass:"form-control",attrs:{name:"change_status"},on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.product,"status",e.target.multiple?s:s[0])},t.updateStatus]}},[s("option",{attrs:{value:"",selected:""}},[t._v("Choose Status")]),t._v(" "),s("option",{attrs:{value:"0"}},[t._v("Inactive")]),t._v(" "),s("option",{attrs:{value:"1"}},[t._v("Draft")]),t._v(" "),s("option",{attrs:{value:"2"}},[t._v("Pending")]),t._v(" "),s("option",{attrs:{value:"3"}},[t._v("Published")]),t._v(" "),s("option",{attrs:{value:"4"}},[t._v("Rejected")])])])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"switch switch-sm col-sm-3"},[s("label",[t._v("Title")])]),t._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.name,expression:"product.name"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.product.name},on:{input:function(e){e.target.composing||t.$set(t.product,"name",e.target.value)}}}),t._v(" "),s("span",{staticClass:"form-text"})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"switch switch-sm col-sm-3"},[s("label",[t._v("Type")])]),t._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.type,expression:"product.type"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.product.type},on:{input:function(e){e.target.composing||t.$set(t.product,"type",e.target.value)}}}),t._v(" "),s("span",{staticClass:"form-text"})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"switch switch-sm col-sm-3"},[s("label",[t._v("Description")])]),t._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.description,expression:"product.description"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.product.description},on:{input:function(e){e.target.composing||t.$set(t.product,"description",e.target.value)}}}),t._v(" "),s("span",{staticClass:"form-text"})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"switch switch-sm col-sm-3"},[s("label",[t._v("Content")])]),t._v(" "),s("div",{staticClass:"col-sm-9"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.product.content,expression:"product.content"}],staticClass:"form-control",domProps:{value:t.product.content},on:{input:function(e){e.target.composing||t.$set(t.product,"content",e.target.value)}}}),t._v(" "),s("span",{staticClass:"form-text"})])])]),t._v(" "),s("div",{staticClass:"col-md-6"})]),t._v(" "),t.product.id?s("div",{staticClass:"row"},[s("div",{staticClass:"col-6"},[t._v("\n                    Ownership\n                ")]),t._v(" "),s("div",{staticClass:"col-6"},[t._v("\n                    Owned by address: "+t._s(t.product.developer)),s("br"),t._v("\n                    Created by Developer ID: "+t._s(t.product.developerId)+"\n                ")]),t._v(" "),s("div",{staticClass:"col-12"},[s("h3",[t._v("Transfer Ownership")]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"switch switch-sm col-sm-3"},[s("label",[t._v("Developer Address")])]),t._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.developer,expression:"product.developer"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.product.developer},on:{input:function(e){e.target.composing||t.$set(t.product,"developer",e.target.value)}}}),t._v(" "),s("span",{staticClass:"form-text"})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"switch switch-sm col-sm-3"},[s("label",[t._v("Developer ID")])]),t._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.product.developer_id,expression:"product.developer_id"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.product.developer_id},on:{input:function(e){e.target.composing||t.$set(t.product,"developer_id",e.target.value)}}}),t._v(" "),s("span",{staticClass:"form-text"})])]),t._v(" "),s("c-button",{on:{click:t.transferOwnership}},[t._v("Transfer")])],1)]):t._e(),t._v(" "),s("div",{staticClass:"row"},[t.product.id?s("div",{staticClass:"col-2 offset-10"},[s("a",{staticClass:"btn btn-primary",attrs:{href:"#",target:"_blank"},on:{click:function(e){return e.preventDefault(),t.save(e)}}},[t._v("SAVE")])]):t._e(),t._v(" "),t.product.id?t._e():s("div",{staticClass:"col-2 offset-10"},[s("a",{staticClass:"btn btn-primary",attrs:{href:"#",target:"_blank"},on:{click:function(e){return e.preventDefault(),t.create(e)}}},[t._v("CREATE")])])])])])])},[],!1,null,"a1b57a0a",null);e.default=d.exports},180:function(t,e){},809:function(t,e,s){"use strict";var a=s(180);s.n(a).a}}]);